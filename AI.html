<link rel="stylesheet" type="text/css" href="style.css">
<html>
    <head>
        <title>Joaquin De Losada</title>
    </head>
    <body>
        <h1><a href="index.html">Joaquin De Losadas website!</a></h1>
    </body>
    <div class="container">
        <div class="ledgerTerminal">
            <div class= "typed-text">
                <a href="AboutMe.html">More about me</a>  <a href="GameProjects.html">Game Projects</a>  <a href="AI.html">AI projects</a> <a href="ContactMe.html">Contact Me</a>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="terminal">
            <p class="typed-text">Programming repos</p>
            <p class="smallertyped-text">Finite State Machine (FSM) NPC in Unity</p>
            <p style="font-size: large">This project arises from a passion I have gained in the past few years around understanding and working on AI NPC systems for games. During this time, I've better understood how systems like Finite State Machines, Behavior Trees, and others have evolved over the years and shaped the gaming industry. After some time, I decided that the best course of action as a programmer would be implementing some of the systems myself. The main plan was to spend some months designing and making an AI NPC system. Allowing me to understand better the process that AI/Gameplay programmers and designers would go through when working on the AI systems for a game.</p>
            <p style="font-size: large">The project's first stage was to create and work on a research and design document containing the research for the project and the plans for the AI NPC systems. The paper is organized into three main sections, the introduction, the main body of research, and how the current NPC system operates. The introduction contains a table of contexts, some introductory information about the project, and links to the supporting document alongside this principle document. The research section contains my research on navigation meshes, Finite State Machines (FSM), Behavior Trees, and Utility AI. As well as how these different systems have been implemented and evolved over the years in well-known games. The final section of the document contains an explanation of the FSM I would be implementing, mainly revolving around all the states that would be used and the tasks the state is meant to accomplish.</p>
            <embed src="Files/AI FSM/AI DD.pdf#toolbar=0" type="application/pdf" width="90%" height="600px" />
			<p style="font-size: large">While designing the FSM, I decided that the primary goal of the NPCs would be trying to defend a small base from the player requiring only a tiny amount of state. I landed on having the following 5: Patrol, Idle, Aggression, Attack, and Cover states. In combination, every NPC would have a standard methods script that handles movement for the AI when needed and an AI State Manager that controls changing states and contains information essential for all states. In tandem with the scripts managing individual NPCs, a Director AI is handling all the NPCs as a group and precisely how many NPCs are allowed to change to either the attack state. This helps ensure that only a few NPCs start attacking the player simultaneously, which can be overwhelming and make the game challenging.</p>
			<p style="font-size: large">At the start of the game, all of the NPCS will begin in the Patrol state and be given an array of close patrol positions and close cover positions. As each NPC patrols through their designated points, if the player ever enters visual range or makes noise by shooting, their weapons will alert the enemy, who will transition to the aggressive state. At this point, any NPC that has transitioned to the aggression state will calculate a utility value determining whether the AI would attack the player or run to cover. The value is calculated based on the player's distance to the NPC and all cover points close to the NPC. Once calculated, the value will be stored in the AI State Manager script, and the GameObject will be added to a list of recent NPCs who recently also calculated their utility AI in the Director AI script.</p>
			<p>
			    <video width="640" height="360" controls>
                    <source src="Files/AI FSM/StatesShowcase.mp4" type="video/mp4">
                    Your browser does not support the video tag.
				</video>
            </p>
			<p style="font-size: large">Meanwhile, in the Director AI script, there is a coroutine that will run every few seconds and is meant to go through the list of NPCs waiting for a decision. First, the script will determine if the limit of attacking NPCs has been met for each NPC. Else. It will run a probability determining whether the Attack or Cover state should be chosen. If the NPC is in the attack state, then at this point, they would decide if they needed to approach the player (As they could have moved since last checked) and start shooting at the player. Meanwhile, in the Cover state, the NPC would loop through a set of close cover points to determine which one is the closest to them while still being behind cover and setting a destination for that point. If, at any point in the process since entering the Aggression state, the player leaves a line of sight of the NPC, then it will transition to the Searching state, which has the AI go to the last known position of the player and see if they can regain line of sight of the player else it will return to the patrol state.</p>
            <p style="font-size: large"><a href="https://docs.google.com/document/d/1hRznb8RsCPGlu8isXaYCOTSUT3npHfAZLWOou7tlnAs/edit?usp=sharing">Design Document</a></p>
            <p style="font-size: large"><a href="https://github.com/Montainproductions/FPCharacter-Unity/tree/AI-Unity-Project">Github Repo</a></p>
        </div>
    </div>
</html>